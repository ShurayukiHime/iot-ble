% !TeX spellcheck = en_GB
\chapter{Bluetooth Low Energy Specification}
\label{chapter2}
\thispagestyle{empty}

\noindent In this chapter we briefly report the main technical characteristics of the Bluetooth Low Energy Personal-Area-Network technology. Our main reference is the Core Specification 5.0 available on the official website.

\section{Network Topology and Devices}
Devices can be divided into three categories: Advertisers, Scanners and Initiators. 
Communication has to be started by an initiator device following an \textit{advertisement connectable packet} (\texttt{ADV\_IND}). Advertisement is performed on the primary channels, while bidirectional communication happens on one of the 37 secondary channels, decided during the connection procedure. When a connection is established, the initiator and the advertiser respectively become the master and slave devices; while the former can be involved in more than one communication, the slave device can belong to a single \textit{piconet} at a time. In fact, it is not possible to have a BLE device paired with more than one "master" device at the same time.

Advertising may also be \textit{non-connectable} (\texttt{ADV\_NONCONN\_IND}): the LE device periodically sends its data on the main channel for every scanner to read. This is really convenient in terms of implementation, but it also represent the least secure solution, as data is sent in clear text.

On the whole, the Specification defines six different advertising packets, among which we also report the request for additional information from the advertisement (\texttt{SCAN\_REQ}), it having a direct corresponding bash command.

\section{Decypher Advertising Packets}
Before considering Man-In-The-Middle techniques, we show how it is possible to intercept data from advertising devices, mentioned in the previous chapter.

For this experiment, we used the STM IoT node and tested it on both our Linux distributions. The board simply worked as a thermometer, measuring the temperature in the environment and broadcasting it as a non-connectable advertising packet.